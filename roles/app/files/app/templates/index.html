<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Perplexity AI Messenger</title>
<style>
    body {font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg,#667eea,#764ba2); margin:0; display:flex; justify-content:center; align-items:center; height:100vh;}
    #chat {background: white; width: 100%; max-width: 700px; padding: 1.5em; border-radius: 12px; display: flex; flex-direction: column; height: 80vh; box-shadow:0 4px 20px rgba(0,0,0,0.15);}
    h1 {margin: 0; text-align:center; color:#5a2d82;}
    #response {margin-top:1em; padding:1em; background:#f0f0f6; border-radius:10px; flex-grow:1; overflow-y:auto; border:1px solid #ddd; white-space:pre-wrap;}
    textarea {width:100%; height:80px; border-radius:8px; border:1px solid #ccc; padding:10px; font-size:1rem;}
    textarea:focus {border-color:#7766c0; outline:none; box-shadow:0 0 8px rgba(119,102,192,0.5);}
    button {margin-top:10px; background-color:#7766c0; border:none; color:white; padding:12px; font-size:1.2rem; border-radius:8px; cursor:pointer;}
    button:hover {background-color:#5a2d82;} button:disabled {background-color:#bbb;}
    #loading-spinner {display:none; margin-left:10px; border:3px solid #ccc; border-top:3px solid #7766c0; border-radius:50%; width:20px; height:20px; animation:spin 1s linear infinite;}
    @keyframes spin {0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
</style>
</head>
<body>
<div id="chat">
  <h1>Perplexity AI Messenger</h1>
  <div id="response">Ask me anything!</div>
  <textarea id="question" placeholder="Type your question here..."></textarea>
  <div style="display:flex; align-items:center;">
    <button id="send-button" onclick="sendQuestion()">Send</button>
    <div id="loading-spinner"></div>
  </div>
</div>
<script>
const sendButton = document.getElementById('send-button');
const loadingSpinner = document.getElementById('loading-spinner');
const responseDiv = document.getElementById('response');
async function sendQuestion() {
  const question = document.getElementById('question').value.trim();
  if (!question) { alert('Please enter a question'); return; }
  sendButton.disabled = true; loadingSpinner.style.display = 'inline-block'; responseDiv.textContent = '';
  try {
    const res = await fetch('/ask', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({question})});
    const data = await res.json(); responseDiv.textContent = data.answer;
  } catch (err) { responseDiv.textContent = 'Error: ' + err.message; }
  finally { sendButton.disabled = false; loadingSpinner.style.display = 'none'; }
}
document.getElementById('question').addEventListener('keydown', e => { if ((e.ctrlKey||e.metaKey) && e.key==='Enter') sendQuestion(); });
</script>
</body>
</html>
